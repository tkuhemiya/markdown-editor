@import "tailwindcss";

@theme {
    --color-background: var(--background);
    --color-foreground: var(--foreground);
    --color-card: var(--card);
    --color-card-foreground: var(--card-foreground);
    --color-popover: var(--popover);
    --color-popover-foreground: var(--popover-foreground);
    --color-primary: var(--primary);
    --color-primary-foreground: var(--primary-foreground);
    --color-secondary: var(--secondary);
    --color-secondary-foreground: var(--secondary-foreground);
    --color-muted: var(--muted);
    --color-muted-foreground: var(--muted-foreground);
    --color-accent: var(--accent);
    --color-accent-foreground: var(--accent-foreground);
    --color-destructive: var(--destructive);
    --color-destructive-foreground: var(--destructive-foreground);
    --color-border: var(--border);
    --color-input: var(--input);
    --color-ring: var(--ring);
    --color-chart-1: var(--chart-1);
    --color-chart-2: var(--chart-2);
    --color-chart-3: var(--chart-3);
    --color-chart-4: var(--chart-4);
    --color-chart-5: var(--chart-5);
    --color-sidebar: var(--sidebar);
    --color-sidebar-foreground: var(--sidebar-foreground);
    --color-sidebar-primary: var(--sidebar-primary);
    --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
    --color-sidebar-accent: var(--sidebar-accent);
    --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
    --color-sidebar-border: var(--sidebar-border);
    --color-sidebar-ring: var(--sidebar-ring);
    --color-selected: #8b014d;

    --font-sans: var(--font-sans);
    --font-mono: var(--font-mono);
    --font-serif: var(--font-serif);

    --radius-sm: calc(var(--radius) - 4px);
    --radius-md: calc(var(--radius) - 2px);
    --radius-lg: var(--radius);
    --radius-xl: calc(var(--radius) + 4px);

    --shadow-2xs: var(--shadow-2xs);
    --shadow-xs: var(--shadow-xs);
    --shadow-sm: var(--shadow-sm);
    --shadow: var(--shadow);
    --shadow-md: var(--shadow-md);
    --shadow-lg: var(--shadow-lg);
    --shadow-xl: var(--shadow-xl);
    --shadow-2xl: var(--shadow-2xl);
}

@layer base {
    body {
        @apply bg-background text-foreground;
        background-color: var(--background);
        color: var(--foreground);
        min-height: 100vh;
    }

    /* Headings */
    h1 {
        @apply text-4xl font-bold mb-6 mt-8;
        color: var(--color-foreground);
    }

    h2 {
        @apply text-3xl font-semibold mb-5 mt-7;
        color: var(--color-foreground);
    }

    h3 {
        @apply text-2xl font-semibold mb-4 mt-6;
        color: var(--color-foreground);
    }

    h4 {
        @apply text-xl font-medium mb-3 mt-5;
        color: var(--color-foreground);
    }

    h5 {
        @apply text-lg font-medium mb-3 mt-4;
        color: var(--color-foreground);
    }

    h6 {
        @apply text-base font-medium mb-2 mt-3;
        color: var(--color-foreground);
    }

    /* Paragraphs */
    p {
        @apply mb-4 leading-relaxed;
        color: var(--color-muted-foreground);
    }

    /* Lists */
    ul {
        @apply list-disc list-inside mb-4 space-y-2;
        color: var(--color-muted-foreground);
    }

    ol {
        @apply list-decimal list-inside mb-4 space-y-2;
        color: var(--color-muted-foreground);
    }

    li {
        @apply ml-4 mb-2;
    }

    li p {
        @apply mb-0;
        display: inline;
    }

    li>ul,
    li>ol {
        @apply mt-2 mb-2;
    }

    /* Links */
    a {
        @apply underline transition-colors;
        color: var(--color-primary);
    }

    a:hover {
        color: var(--color-accent);
    }

    /* Emphasis */
    strong,
    b {
        @apply font-bold;
        color: var(--color-foreground);
    }

    em,
    i {
        @apply italic;
    }

    mark {
        @apply px-1 rounded;
        background-color: var(--color-accent);
        color: var(--color-accent-foreground);
    }

    del,
    s {
        @apply line-through;
        color: var(--color-muted-foreground);
        opacity: 0.6;
    }

    ins,
    u {
        @apply underline;
    }

    small {
        @apply text-sm;
        color: var(--color-muted-foreground);
    }

    sub {
        @apply text-xs align-sub;
    }

    sup {
        @apply text-xs align-super;
    }

    /* Code */
    code:not(.hljs) {
        @apply px-1.5 py-0.5 rounded text-sm;
        font-family: var(--font-mono);
        background-color: var(--color-muted);
        color: var(--color-accent-foreground);
    }

    /* Syntax highlighting colors matching app theme */
    .hljs {
        background: transparent;
        color: var(--color-foreground);
    }

    .hljs-keyword {
        color: var(--color-primary);
        font-weight: bold;
    }

    .hljs-string {
        color: var(--color-accent);
    }

    .hljs-number {
        color: var(--color-secondary);
    }

    .hljs-comment {
        color: var(--color-muted-foreground);
        font-style: italic;
    }

    .hljs-function {
        color: var(--color-primary);
    }

    .hljs-variable {
        color: var(--color-foreground);
    }

    .hljs-operator {
        color: var(--color-foreground);
    }

    .hljs-punctuation {
        color: var(--color-muted-foreground);
    }

    .hljs-attribute {
        color: var(--color-accent);
    }

    .hljs-tag {
        color: var(--color-primary);
    }

    .hljs-built_in,
    .hljs-class {
        color: var(--color-secondary);
    }

    pre {
        @apply p-4 overflow-x-auto mb-4;
        font-family: var(--font-mono);
        background-color: var(--color-muted);
        border-radius: var(--radius-lg);
    }

    pre code {
        @apply bg-transparent p-0;
        color: var(--color-foreground);
    }

    /* Blockquotes */
    blockquote {
        @apply border-l-4 pl-4 py-2 mb-4 italic;
        border-color: var(--color-border);
        color: var(--color-muted-foreground);
        background-color: var(--color-muted);
    }

    /* Horizontal Rule */
    hr {
        @apply my-8 border-t-2;
        border-color: var(--color-border);
    }

    /* Tables */
    table {
        @apply w-full border-collapse mb-4 text-sm;
    }

    thead {
        background-color: var(--color-muted);
    }

    th {
        @apply px-4 py-2 text-left font-semibold;
        border: 1px solid var(--color-border);
        color: var(--color-foreground);
    }

    td {
        @apply px-4 py-2;
        border: 1px solid var(--color-border);
        color: var(--color-muted-foreground);
    }

    tbody tr:nth-child(even) {
        background-color: var(--color-muted);
        opacity: 0.5;
    }

    tbody tr:hover {
        background-color: var(--color-accent);
        opacity: 0.3;
    }

    /* Images */
    img {
        @apply max-w-full h-auto mb-4;
        border-radius: var(--radius-lg);
    }

    /* Task Lists */
    input[type="checkbox"] {
        @apply mr-2 cursor-pointer;
        accent-color: var(--color-primary);
    }

    /* Definition Lists */
    dl {
        @apply mb-4;
    }

    dt {
        @apply font-bold mt-2;
        color: var(--color-foreground);
    }

    dd {
        @apply ml-6 mb-2;
        color: var(--color-muted-foreground);
    }

    /* Abbreviations */
    abbr {
        @apply border-b-2 border-dotted cursor-help;
        border-color: var(--color-border);
    }

    /* Keyboard Input */
    kbd {
        @apply px-2 py-1 text-sm shadow-sm;
        font-family: var(--font-mono);
        background-color: var(--color-secondary);
        color: var(--color-secondary-foreground);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-sm);
        box-shadow: var(--shadow-sm);
    }

    /* Sample Output */
    samp {
        @apply px-1;
        font-family: var(--font-mono);
        background-color: var(--color-muted);
        border-radius: var(--radius-sm);
    }

    /* Variables */
    var {
        @apply italic;
        font-family: var(--font-mono);
    }

    /* Figures */
    figure {
        @apply mb-4;
    }

    figcaption {
        @apply text-sm mt-2 text-center italic;
        color: var(--color-muted-foreground);
    }

    /* Details/Summary */
    details {
        @apply mb-4 p-4;
        border: 1px solid var(--color-border);
        border-radius: var(--radius-lg);
        background-color: var(--color-card);
    }

    summary {
        @apply cursor-pointer font-semibold;
        color: var(--color-foreground);
    }

    summary:hover {
        color: var(--color-primary);
    }

    ::selection {
        background-color: var(--color-selected)
    }

    a::selection {
        color: var(--color-accent-foreground)
    }

    /* Remove Tiptap default focus outline */
    .ProseMirror,
    .ProseMirror-focused {
        outline: none !important;
        tab-size: 4;
        -moz-tab-size: 4;
        -webkit-tab-size: 4;
    }

    /* Sidebar styles */
    .sidebar {
        position: fixed;
        left: 0;
        top: 0;
        height: 100vh;
        width: 250px;
        background: var(--color-card);
        border-right: 1px solid var(--color-border);
        transform: translateX(-100%);
        transition: transform 0.3s ease;
        z-index: 1000;
    }

    .sidebar.open {
        transform: translateX(0);
    }

    .sidebar-toggle {
        position: absolute;
        right: -40px;
        top: 10px;
        background: var(--color-primary);
        color: var(--color-primary-foreground);
        border: none;
        padding: 8px 12px;
        border-radius: 0 4px 4px 0;
        cursor: pointer;
        font-size: 16px;
    }

    .sidebar-content {
        padding: 20px;
        height: 100%;
        display: flex;
        flex-direction: column;
    }

    .sidebar-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 1px solid var(--color-border);
    }

    .sidebar-header h3 {
        margin: 0;
        font-size: 18px;
        color: var(--color-foreground);
    }

    .sidebar-header button {
        background: var(--color-primary);
        color: var(--color-primary-foreground);
        border: none;
        padding: 6px 12px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
    }

    .doc-list {
        list-style: none;
        padding: 0;
        margin: 0;
        flex: 1;
        overflow-y: auto;
    }

    .doc-item {
        padding: 10px;
        border-bottom: 1px solid var(--color-border);
        cursor: pointer;
        transition: background-color 0.2s;
    }

    .doc-item:hover {
        background: var(--color-accent);
    }

    .doc-item.current {
        background: var(--color-primary);
        color: var(--color-primary-foreground);
    }

    .doc-item.unsaved {
        font-style: italic;
    }

    .doc-item.saving .doc-name::after {
        content: " (saving...)";
        opacity: 0.6;
    }

    .doc-item.saved .doc-name::after {
        content: " âœ“";
        color: green;
        opacity: 0.8;
    }

    .doc-name {
        font-weight: 500;
        margin-bottom: 4px;
    }

    .doc-date {
        font-size: 12px;
        color: var(--color-muted-foreground);
    }

    .main-content {
        margin-left: 0;
        transition: margin-left 0.3s ease;
        min-height: 100vh;
    }

    .main-content.sidebar-open {
        margin-left: 250px;
    }

    /* Modal styles */
    .modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 2000;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .modal.hidden {
        display: none;
    }

    .modal-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
    }

    .modal-content {
        position: relative;
        background: var(--color-card);
        border: 1px solid var(--color-border);
        border-radius: 8px;
        padding: 20px;
        max-width: 400px;
        width: 90%;
        box-shadow: var(--shadow-lg);
    }

    .modal-content p {
        margin: 0 0 20px 0;
        color: var(--color-foreground);
    }

    .modal-buttons {
        display: flex;
        gap: 10px;
        justify-content: flex-end;
    }

    .modal-buttons button {
        padding: 8px 16px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
    }

    #save-changes {
        background: var(--color-primary);
        color: var(--color-primary-foreground);
    }

    #discard-changes {
        background: var(--color-destructive);
        color: var(--color-destructive-foreground);
    }

    #cancel-action {
        background: var(--color-secondary);
        color: var(--color-secondary-foreground);
    }

    /* Context menu */
    .context-menu {
        position: fixed;
        background: var(--color-card);
        border: 1px solid var(--color-border);
        border-radius: 6px;
        box-shadow: var(--shadow-lg);
        z-index: 3000;
        min-width: 140px;
        padding: 4px 0;
    }

    .context-menu-item {
        padding: 8px 16px;
        cursor: pointer;
        color: var(--color-foreground);
        font-size: 14px;
        transition: background-color 0.2s;
        user-select: none;
    }

    .context-menu-item:hover {
        background: var(--color-accent);
    }

    .context-menu-item[data-action="delete"] {
        color: var(--color-destructive);
    }

    .context-menu-item[data-action="delete"]:hover {
        background: var(--color-destructive);
        color: var(--color-destructive-foreground);
    }

    /* Mobile responsiveness */
    @media (max-width: 768px) {
        .sidebar {
            width: 280px;
            transform: translateX(-100%);
        }

        .main-content.sidebar-open {
            margin-left: 0;
        }

        .sidebar.open {
            transform: translateX(0);
        }
    }

    /* Dividers with text */
    .divider {
        @apply flex items-center my-6;
    }

    .divider::before,
    .divider::after {
        @apply flex-1;
        content: '';
        border-top: 1px solid var(--color-border);
    }

    .divider::before {
        @apply mr-4;
    }

    .divider::after {
        @apply ml-4;
    }
}
